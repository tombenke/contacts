var http = require( 'http' );
var should = require( 'should' );

function get( host, port, url, body, header )
{
    return function( done )
    {
        http.get(
            {
                host: host,
                port: port,
                path: url,
                headers: header
            },

            function( response )
            {
                var buf = '';

                response.should.have.status( 200 );
                response.setEncoding( 'utf8' );

                response.on( 'data', function( chunk )
                {
                    buf += chunk
                });

                response.on( 'end', function()
                {
                    if( body != undefined && body != '' )
                    {
                        buf.should.equal( body );
                    }
                    done();
                });
            }
        )
    }
}

//describe('http', function()
//{
//    it( 'should provide the orgUnitsByKey',
//        function( done )
//        {
//            console.log('run it...');
//            http.get(
//                {
//                    host: host, 
//                    path: '/orgUnitsByKey', 
//                    port: port
//                },
//                function( res )
//                {
//                    console.log( "Got response: ", res );
//                    res.should.have.status( 200 );
//                    done();
//                }
//            )
//        }
//    )
//})

exports.get = get;